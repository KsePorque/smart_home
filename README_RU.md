Smart House
==============
Проект сделан в качестве финального проекта курса с coursera.<br>
<strong>Задача</strong>: реализовать логику работы умного дома. <br>
Умный дом имеет около 20 датчиков, которые показывают, какие приборы включены (стиральная машина, бойлер, кондиционер и т.д). 
Реализованная логика должна управлять домом. Например, выключать электроприборы при задымлении, включать бойлер для подогрева до желаемой температуры, управлять закрытием штор для автоматической регуляции освещенности.
<br><br> 

Подготовка к работе
=============
Завести аккаунт умного дома можно на этом ресурсе: http://smarthome.webpython.graders.eldf.ru<br>
Для работы надо задать несколько переменных среды:
- SMART_HOME_ACCESS_TOKEN (токен для доступа к датчикам умного дома)
- EMAIL_HOST_USER, EMAIL_HOST_PASSWORD, EMAIL_RECEPIENT,EMAIL_USE_SSL - не обязательно. требуется для отправки email-оповещений в случае ошибок сервера

Docker
=============
В проекте созданы файлы для запуска приложения в докере

.. code-block:: bash
    $ docker-compose build
    $ docker-compose up -d


После этого будет запущена сеть, состоящая из нескольких контейнеров. 

На главной странице сервиса расположена панель управления умным домом: http://localhost:8080<br>
Автоматический опрос датчиков и включение/выключение приборов выполняется автоматически (с использованием celery)


Установка (через pipenv)
---------
Альтернативно можно установить через pipenv<br>
Установите pipenv

.. code-block:: bash

    $ pip install pipenv


Установите зависимости проекта, включая зависимости для разработки

.. code-block:: bash

    $ pipenv install --dev

Активируйте virtualenv проекта

.. code-block:: bash

    $ pipenv shell

Запустите миграции

.. code-block:: bash

    $ python manage.py migrate

После этого запустить сервер
.. code-block:: bash

    $ python manage.py runserver 127.0.0.1:8080


Для запуска периодического опроса состояния дома, используется celery.<br> 
Запускается как: celery -A coursera_house.celery worker -l info -B

Celery использует Redis как брокер

Тестирование
------------
Для запуска тестов выполните команду

.. code-block:: bash

    $ py.test tests
